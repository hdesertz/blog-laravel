!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.topo=e():t.topo=e()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=1)}([function(t,e,n){"use strict";t.exports={color:{primary:"#E2003B",pink:"rgba(226, 0, 59, 0.15)",base:"#4B556A",gray:"#89909A",bgGray:"#F1F1F1",white:"#FFF"}}},function(t,e,n){"use strict";(function(e){function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){var n=[],o=!0,i=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){i=!0,r=t}finally{try{!o&&s.return&&s.return()}finally{if(i)throw r}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();n(4);var l=n(0),u=n(5);!function(n){var d="topology",f=n.fn[d],h={monitorPopup:!0,detailPopup:!0,contextMenu:!1},p={CLICK:"click.topology",TAGS_CHANGE:"valueChange.tags.topology",LEVELS_CHANGE:"valueChange.levels.topology",NODE_HOVER:"mouseHover.node.topology",NODE_SINGLE_CLICK:"singleClick.node.topology",NODE_DOUBLE_CLICK:"doubleClick.node.topology"},v={TOPOLOGY:".topology-component",TOOLBAR:".topology-toolbar",TOOLBAR_LEFT:".topology-toolbar-left",TOOLBAR_RIGHT:".topology-toolbar-right",TAGS:".topology-tags",NETWORK:".topology-network",MONITOR_POPUP:".topology-monitor-popup",DETAIL_POPUP:".topology-detail-popup",CONTEXT_NODE_MENU:".topology-context-menu.context-node-menu",BTNS:".topology-btn"},g={TOOLBAR:'\n      <div class="topology-toolbar"></div>\n    ',TOOLBAR_LEFT:'\n      <div class="topology-toolbar-left"></div>\n    ',TOOLBAR_RIGHT:'\n      <div class="topology-toolbar-right">\n        \x3c!--\n        <span class="topology-select" data-action="filter.tag" data-width="180">\n          <span class="glyphicon glyphicon-filter"></span>\n          <span class="select-content">标签</span>\n          <span class="caret"></span>\n        </span>\n        --\x3e\n        <span class="topology-btns-group">\n          <span class="topology-btn active" data-action="direction.vertical">竖直</span>\n          <span class="topology-btn" data-action="direction.horizontal">水平</span>\n        </span>\n        <span class="topology-text-group">\n          显示：\n          <span class="topology-select" data-action="display.level">\n            <span class="select-content"></span>\n            <span class="caret"></span>\n          </span>\n          级\n        </span>\n        <a class="topology-btn" data-action="save">下载</a>\n      </div>\n    ',TAGS:'\n      <div class="topology-tags hide">\n        <span class="left-label">标签：</span>\n        <div class="tags-wrapper"></div>\n        <span class="clear-tags-btn">全部清除</span>\n      </div>\n    ',NETWORK:'\n      <div class="topology-network"></div>\n    ',MONITOR_POPUP:'\n      <div class="topology-monitor-popup hide">\n        <div class="monitor-inner">\n          <div class="monitor-body"></div>\n          <div class="data-loading">\n            <div class="sk-circle">\n              <div class="sk-circle1 sk-child"></div>\n              <div class="sk-circle2 sk-child"></div>\n              <div class="sk-circle3 sk-child"></div>\n              <div class="sk-circle4 sk-child"></div>\n              <div class="sk-circle5 sk-child"></div>\n              <div class="sk-circle6 sk-child"></div>\n              <div class="sk-circle7 sk-child"></div>\n              <div class="sk-circle8 sk-child"></div>\n              <div class="sk-circle9 sk-child"></div>\n              <div class="sk-circle10 sk-child"></div>\n              <div class="sk-circle11 sk-child"></div>\n              <div class="sk-circle12 sk-child"></div>\n            </div>\n            <div class="mt15">数据加载中...</div>\n          </div>\n        </div>\n      </div>\n    ',DETAIL_POPUP:'\n      <div class="topology-detail-popup">\n        <div class="popup-close-btn">\n          <span class="arrow"></span>\n        </div>\n        <div class="detail-body"></div>\n        <div class="data-loading">\n          <div class="sk-circle">\n            <div class="sk-circle1 sk-child"></div>\n            <div class="sk-circle2 sk-child"></div>\n            <div class="sk-circle3 sk-child"></div>\n            <div class="sk-circle4 sk-child"></div>\n            <div class="sk-circle5 sk-child"></div>\n            <div class="sk-circle6 sk-child"></div>\n            <div class="sk-circle7 sk-child"></div>\n            <div class="sk-circle8 sk-child"></div>\n            <div class="sk-circle9 sk-child"></div>\n            <div class="sk-circle10 sk-child"></div>\n            <div class="sk-circle11 sk-child"></div>\n            <div class="sk-circle12 sk-child"></div>\n          </div>\n          <div class="mt15">数据加载中...</div>\n        </div>\n      </div>\n    ',CONTEXT_NODE_MENU:'\n      <div class="topology-context-menu context-node-menu">\n        <div class="context-menu-block">\n          <div class="context-menu-line">节点操作A1</div>\n          <div class="context-menu-line">节点操作A2</div>\n        </div>\n        <div class="context-menu-block">\n          <div class="context-menu-line">节点操作B1</div>\n        </div>\n      </div>\n    '},y={unselected:"imgs/node/node.svg",selected:"imgs/node/node-selected.svg",base:"imgs/node/node-base.svg"},m=function(){function t(e,o){i(this,t),this.config=s({},h,o),this.$root=n(e),this.$toolbar=null,this.$network=null,this.$canvas=null,this.originalData={},this.data={},this.nodes=[],this.edges=[],this.options={},this.network=null,this.direction="vertical",this.tags=[],this._inited=!1,this._pluginUrl=null,this._monitorPopupCloseDelay=300,this._monitorPopupCloseHandler=null}return c(t,[{key:"init",value:function(t){this._inited?this.update(t):(this.initData(t),this.renderToolbar(),this.renderNetwork(),this.renderMonitorPopup(),this.renderDetailPopup(),this.renderContextMenu(),this.initSelect(),this.initEventsListener(),this._inited=!0)}},{key:"update",value:function(t){this.initData(t),this.updateNetwork()}},{key:"initData",value:function(t){var n=this,i={},r={};this.originalData={nodes:t.nodes,edges:t.edges},this.data=e.cloneObj(this.originalData),this.data.edges.forEach(function(t){r[t.from]||(r[t.from]=[]),r[t.to]||(r[t.to]=[]),r[t.from].push(t.to),r[t.to].push(t.from)}),this.data.nodes.forEach(function(t){t.image={unselected:n._getNodeImageUrl("unselected"),selected:n._getNodeImageUrl("selected")},0===e.toNum(t.level)&&(t.image.unselected=n._getNodeImageUrl("base"),t.borderWidth=6,t.borderWidthSelected=6,t.color={background:"transparent",border:l.color.pink,hover:{background:"transparent",border:l.color.pink},highlight:{background:"transparent",border:l.color.pink}},t.shapeProperties={useBorderWithImage:!0}),i[t.level]||(i[t.level]=[]),t.relations=e.isUndefined(r[t.id])?0:r[t.id].length,i[t.level].push(t)});var s={level:0},c={level:200,node:200},u=Object.keys(i).map(function(t){return e.toNum(t)}),d=[],f=[];u.forEach(function(t){t>0?d.push(t):t<0&&f.push(t)}),e.sortArr(d),e.sortArr(f,"desc"),u=[0].concat(d,f);var h=function(t){var n=e.chain(u,"cloneObj","sortArr"),o=n.indexOf(t);return t>0?o--:t<0&&o++,n[o]};u.forEach(function(t,l){var d=h(t);if(0===t){var f=i[0].length,p=c.node*(f-1)/2*-1;i[0].forEach(function(t,e){switch(n.direction){case"vertical":t.x=p+c.node*e,t.y=0;break;case"horizontal":t.x=0,t.y=p+c.node*e}})}else if(0!==t){var v,g=[],y=[];t*u[l-1]<0&&(s.level=0),i[d].forEach(function(e){var n=r[e.id]||[],o=[];i[t].forEach(function(t){n.includes(t.id)&&(y.includes(t.id)?g.forEach(function(e){var n=e.findIndex(function(e){return e.id===t.id});if(n>-1){var o=e.splice(n,1),i=a(o,1),r=i[0];e.push(r)}}):(t.upperNodeId=e.id,o.push(t),y.push(t.id)))}),o.length&&g.push(o)}),g=(v=[]).concat.apply(v,o(g)),i[t].forEach(function(t){y.includes(t.id)||g.push(t)}),i[t]=g}var m=void 0;m=0===t?0:t>0?1:-1,s.level=s.level+c.level*m*Math.pow(i[t].length,.2);var b=[];i[t].forEach(function(t){e.toBool(t.upperNodeId)&&b.push(t.upperNodeId)}),b=e.uniqArr(b);var k=[];if(b.length){b.forEach(function(e){var o=i[d].find(function(t){return t.id===e}),r=i[t].filter(function(t){return t.upperNodeId===e}),a=r.length,l={};switch(n.direction){case"vertical":l={id:e,start:o.x-c.node*a/2,end:o.x+c.node*a/2};break;case"horizontal":l={id:e,start:o.y-c.node*a/2,end:o.y+c.node*a/2}}l.originalStart=l.start,l.originalEnd=l.end,l.base=(l.start+l.end)/2,k.push(l),r.forEach(function(t,e){switch(n.direction){case"vertical":t.x=c.node*(a-1)/2*-1+c.node*e+o.x,t.y=s.level;break;case"horizontal":t.x=s.level,t.y=c.node*(a-1)/2*-1+c.node*e+o.y}})});var O=[];!function t(n){var o=0,i=!1;n.forEach(function(t,o){if(o){var r=n[o-1];if(t.start-r.end<0&&!i){var a=[r.id,t.id],s=0;O.forEach(function(n,o){var i=n.includes(r.id),s=n.includes(t.id);i&&(e.removeArrItem(a,r.id),a=n.concat(a)),s&&(e.removeArrItem(a,t.id),a=a.concat(n)),(i||s)&&O.splice(o,1)}),O.push(a),a=a.map(function(t){return n.find(function(e){return e.id===t})}),a.forEach(function(t){var e=t.end-t.start;s+=e});var c=(a[0].base+e.getArrLastItem(a).base)/2-s/2;a.forEach(function(t,e){var n=e?a[e-1].end:c;t.adjust=n-t.originalStart,t.start=t.originalStart+t.adjust,t.end=t.originalEnd+t.adjust}),i=!0}}}),o++,i&&o<999&&t(n)}(k),k.forEach(function(e){e.adjust&&i[t].filter(function(t){return t.upperNodeId===e.id}).forEach(function(t){switch(n.direction){case"vertical":t.x+=e.adjust;break;case"horizontal":t.y+=e.adjust}})})}if(k.length){var w=e.getArrLastItem(k).end-c.node/2;i[t].forEach(function(t){if(e.isUndefined(t.x))switch(w+=c.node,n.direction){case"vertical":t.x=w,t.y=s.level;break;case"horizontal":t.x=s.level,t.y=w}})}else{var A=i[t].filter(function(t){return e.isUndefined(t.x)}).length,N=c.node*(A-1)/2*-1;i[t].forEach(function(t){if(e.isUndefined(t.x)){switch(n.direction){case"vertical":t.x=N,t.y=s.level;break;case"horizontal":t.x=s.level,t.y=N}N+=c.node}})}})}},{key:"renderToolbar",value:function(){this.$root.find(v.TOOLBAR).length||this.$root.append(g.TOOLBAR),this.$toolbar=this.$root.find(v.TOOLBAR),this.$toolbar.find(v.TOOLBAR_LEFT).length||this.$toolbar.append(g.TOOLBAR_LEFT),this.$toolbar.find(v.TOOLBAR_RIGHT).length||this.$toolbar.append(g.TOOLBAR_RIGHT)}},{key:"renderTags",value:function(){var t=this;this.$root.find(v.TAGS).length||this.$root.append(g.TAGS),this.$root.find(v.TAGS).find(".clear-tags-btn").on("click",function(){t.removeTag()})}},{key:"renderNetwork",value:function(){var t=this._getNetworkData();this.$root.find(v.NETWORK).length||this.$root.append(g.NETWORK),this.$network=this.$root.find(v.NETWORK),this.options=u.network,this.network=new vis.Network(this.$network.get(0),t,this.options),this.$canvas=this.$network.find("canvas")}},{key:"updateNetwork",value:function(){var t=this._getNetworkData();this.network.setData(t)}},{key:"renderMonitorPopup",value:function(){var t=this;if(this.config.monitorPopup){this.$network.find(v.MONITOR_POPUP).length||this.$network.append(g.MONITOR_POPUP);this.$network.find(v.MONITOR_POPUP).find(".monitor-body").removeClass("column-1 column-2"),n("body").on("mouseenter",v.MONITOR_POPUP+" .monitor-inner",function(){clearTimeout(t._monitorPopupCloseHandler)}),n("body").on("mouseleave",v.MONITOR_POPUP+" .monitor-inner",function(){t.hideMonitorPopup()})}}},{key:"renderDetailPopup",value:function(){var t=this;this.config.detailPopup&&(this.$network.find(v.DETAIL_POPUP).length||this.$network.append(g.DETAIL_POPUP),this.$network.find(v.DETAIL_POPUP+" .popup-close-btn").on("click",function(){t.hideDetailPop()}))}},{key:"renderContextMenu",value:function(){var t=this;this.config.contextMenu&&(this.$network.find(v.CONTEXT_NODE_MENU).length||this.$network.append(g.CONTEXT_NODE_MENU),this.$network.find(v.CONTEXT_NODE_MENU).on("mouseleave",function(){t.hideContextMenu()}),n(document).on("click",function(e){n(e.target).closest(v.CONTEXT_NODE_MENU).length||t.hideContextMenu()}))}},{key:"initSelect",value:function(){var t=this;this.$root.find(".topology-select").each(function(o,i){var r=n(i).data("action"),a=n(i).data("width")||"100%",s=t.$root.find('select[data-for="'+r+'"]'),c=s.val(),l=n('\n          <div class="topology-dropdown">\n            <div class="dropdown-items"></div>\n          </div>\n        '),u=n('\n          <div class="dropdown-search">\n            <input class="input-search" placeholder="搜索标签">\n            <span class="glyphicon glyphicon-search"></span>\n          </div>\n        ');switch(r){case"filter.tag":l.prepend(u),u.find(".input-search").on("input",function(t){var e=n(t.target).closest(".input-search"),o=e.val().toLowerCase();o?n(i).find(".dropdown-item").each(function(t,e){var i=n(e).text()||"",r=n(e).attr("data-value")||"";i.toLowerCase().includes(o)||r.toLowerCase().includes(o)?n(e).removeClass("hide"):n(e).addClass("hide")}):n(i).find(".dropdown-item").removeClass("hide")});break;case"display.level":n(i).find(".select-content").text(c)}s.find("option").each(function(t,e){var o=n('<div class="dropdown-item" data-value="'+(n(e).attr("value")||n(e).text())+'">'+n(e).text()+"</div>");switch(r){case"filter.tag":var i=n(e).data("color"),s='<span class="color-block" style="background-color: '+i+'"></span>';o.attr("data-color",i).prepend(s)}l.css({width:a}),l.find(".dropdown-items").append(o)}),n(i).append(l),n(i).on("click",function(e){if(!n(e.target).closest(".topology-dropdown").length){var o=n(e.target).closest(".topology-select"),i=o.find(".topology-dropdown").hasClass("active");t.$root.find(".topology-dropdown").removeClass("active"),i||o.find(".topology-dropdown").addClass("active")}}),n(i).find(".topology-dropdown .dropdown-item").on("click",function(o){var r=n(o.target).closest(".topology-select"),a=n(o.target).closest(".topology-dropdown"),s=n(o.target).closest(".dropdown-item"),c=n(i).find(".select-content"),l=r.data("action"),u=s.data("value"),d=s.text(),f=s.data("color");switch(l){case"filter.tag":t.addTag({value:u,text:d,color:f});break;case"display.level":c.text(u),t.$root.trigger(p.LEVELS_CHANGE,e.toNum(u))}a.removeClass("active")})}),n("body").on("click",function(t){n(t.target).closest(".topology-select").length||(n(".topology-dropdown").removeClass("active"),setTimeout(function(){n(".topology-dropdown .input-search").val("").trigger("input")},300))})}},{key:"initEventsListener",value:function(){var t=this;this.network.on("click",function(e){if(e.nodes.length){var n=e.nodes[0],o=t.originalData.nodes.find(function(t){return t.id===n});t.$root.trigger(p.NODE_SINGLE_CLICK,o),t.showDetailPopupLoading()}else t.hideDetailPop()}),this.network.on("doubleClick",function(e){if(e.nodes.length){var n=e.nodes[0],o=t.originalData.nodes.find(function(t){return t.id===n});t.$root.trigger(p.NODE_DOUBLE_CLICK,o)}}),this.network.on("hoverNode",function(e){var n=e.node,o=t.originalData.nodes.find(function(t){return t.id==n}),i=t.network.getBoundingBox(n),r={x:(i.left+i.right)/2,y:i.top},a=t.network.canvasToDOM(r);t.nodes.update({id:n,image:t._getNodeImageUrl("selected")}),t.$canvas.css({cursor:"pointer"}),clearTimeout(t._monitorPopupCloseHandler),t.showMonitorPopupLoading(a),t.$root.trigger(p.NODE_HOVER,o)}),this.network.on("blurNode",function(n){var o=n.node,i=t.originalData.nodes.find(function(t){return t.id==o});t.nodes.update({id:o,image:{unselected:e.toNum(i.level)?t._getNodeImageUrl("unselected"):t._getNodeImageUrl("base"),selected:t._getNodeImageUrl("selected")}}),t.$canvas.css({cursor:"default"}),t._monitorPopupCloseHandler=setTimeout(function(){t.hideMonitorPopup()},t._monitorPopupCloseDelay)}),this.network.on("oncontext",function(n){var o=n.pointer.DOM.x,i=n.pointer.DOM.y,r=t.network.getNodeAt({x:o,y:i});t.hideContextMenu(),e.isUndefined(r)||t.showContextMenu("node",{x:o,y:i})}),this.$canvas.on("contextmenu",function(t){t.preventDefault()}),this.network.on("zoom",function(){t.hideContextMenu()}),this.network.on("resize",function(){t.hideContextMenu()}),this.network.on("beforeDrawing",function(e){var n=t.$canvas.width(),o=t.$canvas.height();e.fillStyle="#FFF",e.fillRect(999*-n,999*-o,1999*n,1999*o)}),n("body").on("click",function(e){n(e.target).closest(".topology-network").length||t.hideDetailPop()})}},{key:"addTag",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.value&&!this.tags.includes(e.value)){var o=n('\n        <span class="tag-item" data-value="'+e.value+'" style="background-color: '+e.color+'">\n          '+e.text+'\n          <span class="remove-tag">×</span>\n        </span>\n      ');o.find(".remove-tag").on("click",function(){t.removeTag(e.value)}),this.$root.find(v.TAGS).find(".tags-wrapper").append(o),this.tags.push(e.value),this.afterTagsChange()}}},{key:"removeTag",value:function(t){e.isUndefined(t)?(this.$root.find(v.TAGS).find(".tags-wrapper").empty(),this.tags=[]):(this.$root.find(v.TAGS).find('.tag-item[data-value="'+t+'"]').remove(),e.removeArrItem(this.tags,t)),this.afterTagsChange()}},{key:"afterTagsChange",value:function(){var t=this.$root.find(v.TAGS);this.tags.length?t.removeClass("hide"):t.addClass("hide"),this.$root.trigger(p.TAGS_CHANGE,{tags:this.tags})}},{key:"showMonitorPopupLoading",value:function(t){if(this.config.monitorPopup){var e=this.$root.find(v.MONITOR_POPUP),n=t.y-100-6,o=t.x-60;e.find(".monitor-body").addClass("hide"),e.find(".data-loading").removeClass("hide"),e.css({top:n,left:o}).removeClass("hide"),e.data({top:n,left:o})}}},{key:"showMonitorPopup",value:function(){if(this.config.monitorPopup){var t=this.$root.find('.monitor-body[data-for="nodeMonitor"]'),o=t.prop("class");if(t.length){var i=this.$root.find(v.MONITOR_POPUP);i.find(".data-loading").addClass("hide"),i.find(".monitor-body").html(t.html()).addClass(o).removeClass("hide").css("height","auto"),i.find(".monitor-content").addClass("hide"),i.find(".monitor-tab.active").length||i.find(".monitor-tab").eq(0).addClass("active"),i.find(".monitor-tab").on("click",function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n(t.target).closest(".monitor-tab"),r=o.index(),a=o.position().left,s=o.outerWidth();i.find(".monitor-tab").removeClass("active"),o.addClass("active"),i.find(".monitor-content").removeClass("active"),i.find(".monitor-content").eq(r).addClass("active"),i.find(".active-border").animate({left:a,width:s},e.firstTime?0:200)}),i.find(".monitor-tab.active").trigger("click",{firstTime:!0});var r=[];i.find(".monitor-content").map(function(t,e){r.push(n(e).find(".monitor-item").length)});var a=e.getArrGreatestItem(r),s=void 0,c=r[i.find(".monitor-tab.active").index()],l=void 0;a>6?(a%2!=0&&(a+=1),c%2!=0&&(c+=1),s=a/2*20,l=c/2*20,i.find(".monitor-body").addClass("column-2")):(s=20*a,l=20*c,i.find(".monitor-body").addClass("column-1"));var u=s-l,d=i.find(".monitor-body").outerHeight()+u,f=i.find(".monitor-body").outerWidth(),h=i.data("top")-(d-100),p=i.data("left")-(f-120)/2;i.css({top:h,left:p}),i.find(".monitor-body").css({height:d})}}}},{key:"hideMonitorPopup",value:function(){this.config.monitorPopup&&this.$root.find(v.MONITOR_POPUP).addClass("hide")}},{key:"showDetailPopupLoading",value:function(){if(this.config.detailPopup){var t=this.$root.find(v.DETAIL_POPUP);t.find(".detail-body").addClass("hide"),t.find(".data-loading").removeClass("hide"),t.addClass("active")}}},{key:"showDetailPopup",value:function(){if(this.config.detailPopup){var t=this.$root.find('.detail-body[data-for="nodeDetail"]');if(t.length){var e=this.$root.find(v.DETAIL_POPUP);e.find(".detail-body").html(t.html()).removeClass("hide"),e.find(".data-loading").addClass("hide")}}}},{key:"hideDetailPop",value:function(){this.config.detailPopup&&(this.$root.find(v.DETAIL_POPUP).removeClass("active"),this.network.selectNodes([]))}},{key:"showContextMenu",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.config.contextMenu){var n=void 0;switch(t){case"node":n=v.CONTEXT_NODE_MENU}this.$root.find(n).css({left:e.x,top:e.y}).addClass("active")}}},{key:"hideContextMenu",value:function(){this.config.contextMenu&&this.$root.find(v.CONTEXT_NODE_MENU).removeClass("active")}},{key:"toolbarBtnsClick",value:function(t){var e=n(t).data("action").split("."),o=a(e,2),i=o[0],r=o[1],s=n(t).closest(".topology-btns-group");switch(s.length&&(s.find(".topology-btn").length>1?(s.find(".topology-btn").removeClass("active"),n(t).addClass("active")):n(t).toggleClass("active")),i){case"direction":this.changeDirection(r);break;case"save":this.saveCanvas()}}},{key:"changeDirection",value:function(t){this.direction=t,this.update(this.originalData);try{this.options.edges.smooth.forceDirection=t,this.network.setOptions(this.options)}catch(t){}}},{key:"saveCanvas",value:function(){var t=this.$canvas.get(0),e=this.$root.find('[data-action="save"]'),n=this.$root.find(v.TOOLBAR+" .topology-toolbar-name").text().trim()||"",o=n+" 拓扑结构.png";if(t.msToBlob){var i=t.msToBlob();window.navigator.msSaveBlob(i,o)}else e.attr({href:t.toDataURL(),download:o})}},{key:"_getNetworkData",value:function(){return this.nodes=new vis.DataSet(this.data.nodes),this.edges=new vis.DataSet(this.data.edges),{nodes:this.nodes,edges:this.edges}}},{key:"_getNodeImageUrl",value:function(t){if(!this._pluginUrl){var n=document.scripts,o=void 0;e.forEachObj(n,function(t){if(/\/topology[^\/]*\.js/.test(t.src)){var e=t.src.lastIndexOf("/");o=t.src.substring(0,e+1)}}),this._pluginUrl=o||"./"}return""+this._pluginUrl+y[t]}}],[{key:"_getClassName",value:function(t){return t=t.replace(/\./g,"")}},{key:"_jQueryInterface",value:function(e){for(var o=arguments.length,i=Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var s=this,c=void 0,l=s.each(function(o,a){var s=n(a).data("topology"),l=n.extend({},t.Default,n(a).data(),"object"===(void 0===e?"undefined":r(e))&&e);if(s||(s=new t(a,l),n(a).data("topology",s)),"string"==typeof e){var u;if(void 0===s[e])throw new Error('No method named "'+e+'"');c=(u=s)[e].apply(u,i)}});return void 0===c?l:c}},{key:"_toolbarBtnsClickHandler",value:function(t){var e=n(t.target).closest(v.TOPOLOGY);e.length&&e.data("topology").toolbarBtnsClick(t.target)}},{key:"Default",get:function(){return h}}]),t}();n(document).on(p.CLICK,v.BTNS,m._toolbarBtnsClickHandler),n.fn[d]=m._jQueryInterface,n.fn[d].Constructor=m,n.fn[d].noConflict=function(){return n.fn[d]=f,m._jQueryInterface},t.exports=m}(jQuery)}).call(e,n(2))},function(t,e,n){"use strict";var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},i=n(3),r=o({},i);t.exports=r},function(t,e,n){!function(e,n){t.exports=n()}(0,function(){return function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=12)}([function(t,e,n){"use strict";(function(e){function n(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(this,t),this.funcs=e,this.outputModule={},this.injectFuncs(),this.freezeFuncs(),this.outputModule}return i(t,[{key:"injectFuncs",value:function(){var t=this;Object.keys(this.funcs).forEach(function(o,i){t.outputModule[o]=function(){for(var i=arguments.length,r=Array(i),a=0;a<i;a++)r[a]=arguments[a];void 0===r[0]&&(r=[]);var s=r.map(function(t,e){return"function"==typeof t?t:JSON.parse(JSON.stringify(t))});if(s.length)for(var c=s.length-1;c>0;c--)s.splice(c,0,",");return function(){try{var i=t.funcs[o].apply(t.outputModule,r);if(e.showTrace()){var a,c=["[trace] "+o];s.length&&(c=[c[0]+" | params >"].concat(n(s))),c=[].concat(n(c),["| result >",i]),(a=console).info.apply(a,n(c))}return i}catch(t){if(e.showErr()){var l,u=["[error] "+o];s.length&&(u=[u[0]+" | params >"].concat(n(s))),(l=console).error.apply(l,n(u))}return null}}()}})}},{key:"freezeFuncs",value:function(){Object.freeze(this.outputModule)}}]),t}();t.exports=r}).call(e,n(2))},function(t,e,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(0),r=function(t){return t&&t.__esModule?t:{default:t}}(i),a=new r.default({getType:function(t){return Number.isNaN(t)?"NaN":"number"!=typeof t||Number.isFinite(t)?null===t?String(t):"object"!==(void 0===t?"undefined":o(t))?void 0===t?"undefined":o(t):Object.prototype.toString.call(t).toLowerCase().match(/\[\s*object\s*([^\]]*)\s*\]/)[1]:"Infinity"},isStr:function(t){return"string"===this.getType(t)},isNum:function(t){return"number"===this.getType(t)},isArr:function(t){return"array"===this.getType(t)},isObj:function(t){return"object"===this.getType(t)},isFunc:function(t){return"function"===this.getType(t)},isRegExp:function(t){return"regexp"===this.getType(t)},isBool:function(t){return"boolean"===this.getType(t)},isDate:function(t){return"date"===this.getType(t)},isNull:function(t){return"null"===this.getType(t)},isUndefined:function(t){return"undefined"===this.getType(t)},toStr:function(t){return t.toString()},toNum:function(t){return Number(t)},toBool:function(t){return!!t},objToArr:function(t){return Object.keys(t).map(function(e){return t[e]})}});t.exports=a},function(t,e,n){"use strict";var o={isDev:function(){return!1},isNotDev:function(){return!0},showTrace:function(){return this.isDev()&&!0},showErr:function(){return this.isDev()&&!0}};t.exports=o},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}var i=n(0),r=o(i),a=n(1),s=o(a),c=new r.default({getArrLen:function(t){return t.length},isArrEmpty:function(t){return!this.getArrLen(t)},countArrItem:function(t,e){return t.filter(function(t){return t===e}).length},addArrUniqItem:function(t,e){return t.includes(e)||t.push(e),t},removeArrItem:function(t,e){return t.includes(e)&&t.splice(t.indexOf(e),1),t},toggleArrItem:function(t,e){var n=t.indexOf(e);return-1===n?t.push(e):t.splice(n,1),t},sortArr:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=void 0;return n=t.every(function(t){return s.default.isNum(t)})?t.sort(function(t,e){return t-e}):t.sort(),"desc"===e&&(n=n.reverse()),n},sortArrBy:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"asc",o=t.sort(function(t,n){return t[e]>n[e]?1:t[e]<n[e]?-1:0});return"desc"===n&&(o=o.reverse()),o},getArrGreatestItem:function(t){return this.sortArr(t,"desc")[0]},getArrLeastItem:function(t){return this.sortArr(t)[0]},getArrGreatestItemBy:function(t,e){return this.sortArrBy(t,e,"desc")[0]},getArrLeastItemBy:function(t,e){return this.sortArrBy(t,e)[0]},getArrLastItem:function(t){return t[this.getArrLen(t)-1]},getArrSample:function(t){var e=this.getArrLen(t);return t[Math.floor(Math.random()*e)]},shuffleArr:function(t){for(var e=JSON.parse(JSON.stringify(t)),n=[];e.length;){var o=Math.floor(Math.random()*e.length);n.push(e[o]),e.splice(o,1)}return n},getArrRepeatedItems:function(t,e){var n={};t.forEach(function(t){var e=JSON.stringify(t);s.default.isUndefined(n[e])?n[e]=1:n[e]++});var o=[];switch(s.default.getType(e)){case"number":case"string":e=s.default.toNum(e),Object.keys(n).forEach(function(t){n[t]===e&&o.push(JSON.parse(t))});break;case"function":Object.keys(n).forEach(function(t){e(n[t])&&o.push(JSON.parse(t))});break;default:Object.keys(n).forEach(function(t){o.push(JSON.parse(t))})}return o},uniqArr:function(t){return this.getArrRepeatedItems(t)},unionArr:function(){for(var t=this,e=[],n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];return o.forEach(function(n){e=e.concat(t.uniqArr(n))}),this.getArrRepeatedItems(e)},intersectArr:function(){for(var t=this,e=[],n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];return o.forEach(function(n){e=e.concat(t.uniqArr(n))}),this.getArrRepeatedItems(e,o.length)},complementArr:function(){for(var t=this,e=[],n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];return o.forEach(function(n){e=e.concat(t.uniqArr(n))}),this.getArrRepeatedItems(e,1)}});t.exports=c},function(t,e,n){"use strict";var o=n(0),i=function(t){return t&&t.__esModule?t:{default:t}}(o),r=new i.default({getUserAgent:function(){return window.navigator.userAgent},isMobile:function(){return/mobile/i.test(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getUserAgent())},isPhone:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getUserAgent();return this.isMobile(t)&&!this.isPad(t)},isPad:function(){return/pad/i.test(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getUserAgent())},isAndroid:function(){return/Android/i.test(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getUserAgent())},isiOS:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getUserAgent();return this.isiPhone(t)||this.isiPad(t)||this.isiPod(t)},isiPhone:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getUserAgent();return/iPhone/.test(t)&&!/iPod/.test(t)},isiPad:function(){return/iPad/.test(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getUserAgent())},isiPod:function(){return/iPod/.test(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getUserAgent())}});t.exports=r},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var r=n(0),a=o(r),s=n(1),c=o(s),l=new a.default({execFunc:function(t){if(c.default.isFunc(t)){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return t.apply(void 0,i(n))}return null}});t.exports=l},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}var i=n(0),r=o(i),a=n(1),s=o(a),c=new r.default({mobileMask:function(t){return t=s.default.toStr(t),""+t.slice(0,3)+"*".repeat(4)+t.slice(-4)},emailMask:function(t){var e=t.split("@");return t=e[0].length>4?e[0].slice(0,-4)+"****@"+e[1]:""+e[0].charAt(0)+"*".repeat(e[0].length-1)+"@"+e[1]},idNumMask:function(t){t=s.default.toStr(t);var e=3,n=-4,o=7;return t.length<=4?""+t.slice(0,1)+"*".repeat(t.length-1):(t.length>4&&t.length<=8&&(e=1,n=-2,o=3),""+t.slice(0,e)+"*".repeat(t.length-o)+t.slice(n))}});t.exports=c},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}var i=n(0),r=o(i),a=n(1),s=o(a),c=new r.default({sum:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return s.default.isArr(e[0])&&(e=e[0]),e.reduce(function(t,e){return t+s.default.toNum(e)})},mean:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return s.default.isArr(e[0])&&(e=e[0]),this.sum(e)/e.length},multiply:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return s.default.toNum(t)*Math.pow(e,s.default.toNum(n))},multiply1k:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.multiply(t,1e3,e)},multiply1024:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.multiply(t,1024,e)},devide:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return s.default.toNum(t)/Math.pow(e,s.default.toNum(n))},devide1k:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.devide(t,1e3,e)},devide1024:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.devide(t,1024,e)},fillZero:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left";t=s.default.toStr(t);var o=t.length;return o>=e?t:"right"===n?""+t+"0".repeat(e-o):""+"0".repeat(e-o)+t}});t.exports=c},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}var i=n(0),r=o(i),a=n(1),s=o(a),c=new r.default({getObjLen:function(t){return Object.keys(t).length},hasObjKey:function(t,e){return!s.default.isUndefined(t[e])},isObjEmpty:function(t){return!this.getObjLen(t)},isObjEqual:function(t,e){return JSON.stringify(t)===JSON.stringify(e)},cloneObj:function(t){return JSON.parse(JSON.stringify(t))},forEachObj:function(t,e){var n=Object.keys(t);return n.forEach(function(n){e(t[n],n)}),n.length}});t.exports=c},function(t,e,n){"use strict";var o=n(0),i=function(t){return t&&t.__esModule?t:{default:t}}(o),r=new i.default({getStrLen:function(t){return t.length},capitalize:function(t){return t.replace(/\b[a-z]/g,function(t){return t.toUpperCase()})},kebabCase:function(t){return t.map(function(t){return t}).join("-")},camelCase:function(t){var e=this;return t.map(function(t,n){return n?e.capitalize(t):t}).join("")},capitalCamelCase:function(t){var e=this;return t.map(function(t){return e.capitalize(t)}).join("")}});t.exports=r},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}var i=n(0),r=o(i),a=n(1),s=o(a),c=new r.default({sseSupport:function(){return!s.default.isUndefined(window.EventSource)}});t.exports=c},function(t,e,n){"use strict";var o=n(0),i=function(t){return t&&t.__esModule?t:{default:t}}(o),r=new i.default({buildQueryStr:function(t){var e=[];return Object.keys(t).forEach(function(n,o){e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]))}),e.join("&")},getQueryParams:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.search,e=void 0,n={};return e=t?"?"===t.charAt(0)?t.slice(1).split("&"):t.split("&"):[],e.forEach(function(t,e){var o=t.split("=");n[o[0]]=o[1]}),n}});t.exports=r},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},a=n(0),s=o(a),c=n(3),l=o(c),u=n(4),d=o(u),f=n(5),h=o(f),p=n(6),v=o(p),g=n(7),y=o(g),m=n(8),b=o(m),k=n(9),O=o(k),w=n(10),A=o(w),N=n(1),T=o(N),P=n(11),_=o(P),E=r({},l.default,d.default,h.default,v.default,y.default,b.default,O.default,A.default,T.default,_.default),x=new s.default({chain:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(e.length<2)return e[0];var o=e.shift();return e.forEach(function(t){var e=void 0,n=void 0;T.default.isArr(t)?(e=t.shift(),n=[o].concat(i(t))):(e=t,n=[o]),void 0!==E[e]&&(e=E[e].bind(E)),o=e.apply(void 0,i(n))}),o}});E=r({},E,x),Object.freeze(E),t.exports=E}])})},function(t,e){},function(t,e,n){"use strict";var o={network:n(6)};t.exports=o},function(t,e,n){"use strict";t.exports={layout:n(7),nodes:n(8),edges:n(9),interaction:n(10),physics:n(11)}},function(t,e,n){"use strict";t.exports={}},function(t,e,n){"use strict";var o=n(0);t.exports={shape:"image",font:{vadjust:1,background:"rgba(255, 255, 255, 0)",color:o.color.base,size:13},chosen:{node:function(t,e,n,o){},label:function(t,e,n,o){}}}},function(t,e,n){"use strict";var o=n(0);t.exports={width:1.5,color:o.color.gray,font:{size:13,color:"transparent",strokeWidth:0},arrows:{to:{enabled:!0,scaleFactor:.5,type:"arrow"}},smooth:{type:"cubicBezier",forceDirection:"vertical",roundness:.3},chosen:{edge:function(t,e,n,i){t.color=o.color.primary},label:function(t,e,n,i){t.color=o.color.base,t.strokeWidth=10}}}},function(t,e,n){"use strict";t.exports={hover:!0,navigationButtons:!0,keyboard:!0}},function(t,e,n){"use strict";t.exports={enabled:!1}}])});